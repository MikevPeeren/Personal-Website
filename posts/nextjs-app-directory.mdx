---
title: "Next.js App Directory"
author: "Mike van Peeren"
description: "Next.js has been a game-changer in the world of web development, especially for developers using React. With the introduction of the App Directory, Next.js has taken a significant leap forward, offering a more efficient and powerful way to build applications."
publishDate: "June 1, 2023"
imageAlt: "App folder visual view"
imageSrc: "/stocks/next-app-router.png"
---

<img src="/stocks/development.png" />
<small>Image Source: Unsplash</small>

Next.js has been a game-changer in the world of web development, especially for developers using React. With the introduction of the App Directory, Next.js has taken a significant leap forward, offering a more efficient and powerful way to build applications. In this comprehensive guide, we will explore the ins and outs of the Next.js App Directory, its advantages, and how it fits into the overall landscape of web development.

## Table of contents

## Introduction to Next.js App Directory

The App Directory is a new approach to building applications in Next.js, utilizing the latest features of React and offering a more natural evolution of the existing file-system-based router found in the Pages Directory. It provides a more efficient and flexible way to manage routes and rendering in your Next.js applications, making the most of React's concurrent features such as React Suspense.

### What is the App Directory?

<img src="/stocks/next-app-router.png" />
<small>Image Source: Next.js</small>

The App Directory is a new strategy for handling routes and rendering views in Next.js applications. It is designed to work seamlessly with React's concurrent features, such as React Suspense, and offers several significant improvements to application architecture, including partial routing, route groups, parallel routes, intercepting routes, server components vs. client components, suspense boundaries, and more.

### Why use the App Directory?

For new applications, the App Directory is the recommended approach, as it offers a more efficient and powerful way to build your application. For existing applications, you can incrementally migrate to the App Directory, allowing you to leverage its benefits progressively.

## Understanding the Building Blocks of the App Directory

The App Directory is built around the concept of the "Layout per Page" architecture. In this section, we will explore the key components and concepts that make up the App Directory.

### Root Layout Component

The Root Layout component replaces the traditional \_app and \_document components found in the Pages Directory. It serves as the primary layout that wraps your entire application.

```js
export function RootLayout({ children }: { children: React.ReactNode }) {
  return (
    <html lang="en">
      <body>{children}</body>
    </html>
  );
}
```

The Root Layout component is a server component that does not re-render upon navigation, meaning that any data or state within the layout will persist throughout the application's lifecycle.

### Special Components

In addition to the Root Layout component, the App Directory also includes several special components that help manage aspects of your application:

loading.jsx: Defines the Suspense Boundary for an entire route.
error.jsx: Defines the Error Boundary for an entire route.
template.jsx: Similar to the layout, but re-renders upon navigation. Useful for managing state between routes, such as in/out transitions.
These components are nested by default, meaning that, for example, the /about route will be nested within the wrappers of the / route automatically.

### Page Components

Page components are the main components that render for a specific URL segment. These components are not nested by default and will only appear in the DOM when their corresponding URL segment is matched.

## React Server Components

React Server Components (RSC) are a key feature of the App Directory, offering several benefits, including reduced bundle size, streaming components to the browser, and more predictable and cacheable final bundles.

### Advantages of Server Components

Reduced bundle size: Since RSC doesn't carry over their dependencies to the final bundle, your application's bundle size is minimized.
Streaming components: RSC are streamed to the client, enabling progressive enhancement in the browser.
Component-based rendering strategy: RSC allows for a more granular rendering strategy, focusing on individual components instead of entire pages.

### Data Fetching with Server Components

With RSC, data fetching becomes more flexible, and developers can choose between parallel or sequential data fetching, giving them more control over resource loading.

## Extended Fetch API

Next.js extends the standard Fetch API to interact with the server-side HTTP Cache, offering caching strategies such as force-cache, no-store, no-cache, and next.revalidate.

### Caching Strategies

force-cache: Default, looks for a fresh match and returns it.
no-store or no-cache: Fetches from the remote server on every request.
next.revalidate: Sets a hard threshold for considering a resource fresh.
These strategies help developers categorize requests based on their data type, such as static data (e.g., blog posts) and dynamic data (e.g., comments section, shopping cart).

## Migrating from Pages to App Directory

Migration from the Pages Directory to the App Directory can be done incrementally, allowing both architectures to coexist. Next.js provides an upgrade guide to help make the transition as smooth as possible.

### Handling React Context

When migrating to the App Directory, you may encounter issues with React Context, as RSC does not support hooks. To resolve this, you can create a client-side wrapper for your providers.

### TypeScript and Async React Elements

When using async/await outside of Layouts and Pages, TypeScript may yield an error. To resolve this, add a comment in the above line: {/* @ts-expect-error Server Component */}.

### Client-side Fetch in the Future

The React team is working on a use hook that will accept a Promise, handling the promise and returning the value directly. This future development will help standardize client-side fetching in React applications.

## Is the App Directory Ready for Production?

Whether or not you should adopt the App Directory in production depends on your specific use case. For new projects, it's worth considering the App Directory and keeping the Pages Directory as a fallback. For existing projects, the decision depends on the amount of client-side fetching in your application.

## Conclusion

The Next.js App Directory represents the future of web development, offering a more efficient, powerful, and flexible way to build applications. By understanding the key concepts and features of the App Directory, you can make the most of this powerful tool and create web applications that are more performant, scalable, and responsive to user needs.
